<!doctype html>
<html>
<body>
<h2>Login (username or email)</h2>
<form id="f">
<input name="identifier" placeholder="username or email" required /> <br>
<input name="password" placeholder="password" type="password" required /> <br>
<button>Login</button>
</form>
<div id="msg"></div>
<script>
const f = document.getElementById('f');
f.addEventListener('submit', async e => {
e.preventDefault();
const data = Object.fromEntries(new FormData(f).entries());
const r = await fetch('/api/login', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify(data)});
const j = await r.json();
if (r.ok) {
// go to OTP verify page, keep identifier in localStorage for convenience
localStorage.setItem('identifier', data.identifier);
window.location = '/verify.html';
} else {
document.getElementById('msg').innerText = j.error || 'Error';
}
});
</script>
</body>
</html>